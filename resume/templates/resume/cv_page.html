{% extends 'base.html' %}

{% block title %}Mi CV{% endblock %}

{% block content %}

<div class="container">
    <h1>{{ cv.first_name }} {{ cv.last_name }}</h1>
    
    <div class="info-section">
        <p class="info-item"><strong>Email:</strong> <a href="mailto:{{ cv.email }}">{{ cv.email }}</a></p>
        <p class="info-item"><strong>Celular:</strong> {{ cv.phone_number }}</p>
        <p class="info-item"><strong>LinkedIn:</strong> <a href="{{ cv.linkedin_profile }}">{{ cv.linkedin_profile }}</a></p>
        <p class="info-item"><strong>GitHub:</strong> <a href="{{ cv.github_profile }}">{{ cv.github_profile }}</a></p>
    </div>

    <div class="summary">
        <h2>Resumen</h2>
        <p>{{ cv.summary }}</p>
    </div>
    
    <h2>Certificates</h2>
    <div class="certification-carousel" id="carousel">
        {% for certification in certifications %}
            {% if certification.certificate_image %}
                <img id="certificate-image-{{ forloop.counter }}" src="{{ certification.certificate_image.url }}" alt="{{ certification.certificate_name }}" />
            {% endif %}
        {% endfor %}
    </div>
    
    <ul>
        {% for certification in certifications %}
            <li>
                {{ certification.certificate_name }} - {{ certification.institution_name }}
            </li>
        {% endfor %}
    </ul>
    
    <script>
        const carousel = document.getElementById('carousel');
        let index = 0;
        
        const images = carousel.getElementsByTagName('img');
        const imageWidth = images[0]?.clientWidth || 200;
        
        setInterval(() => {
            index = (index + 1) % images.length;
            carousel.scroll({
                left: index * (imageWidth + 10),
                behavior: 'smooth' // Hace que la transici√≥n sea suave
            });
        }, 3000);
        

    </script>

    <h2>Skills</h2>
    <p class = "p1"> <strong>Soft Skills:</strong> {{ skills.soft_skills }}</p>
    <p class = "p1"> <strong>Technical skills:</strong> {{ skills.technical_skills }}</p>

    <h2>Education</h2>
    <ul>
        {% for edu in education %}
        <li>{{ edu.degree }} in {{ edu.institution }} ({{ edu.start_date }} - {{ edu.end_date }})</li>
        <li> {{edu.description}} <li>
        {% endfor %}
    </ul>

    <h2>Work Experience</h2>
    <ul>
        {% for work in work_experience %}
        <li> {{ work.job_title }} en {{ work.company }} ({{ work.start_date }} - {{ work.end_date }})</li>
        <li> {{work.responsibilities}} <li>
        {% endfor %}
    </ul>

    <h2>Projects</h2>
    <ul>
        {% for project in projects %}
        <li>{{ project.name }}: {{ project.description }}</li>
        <li> {{ project.description}} </li>
        {% endfor %}
    </ul>
           
</div>
<div id="spotify-player">
    <h1>Spotify Player</h1>
    <div class="player-controls">
        <button id="prevTrack">Previous</button>
        <button id="togglePlay">Play/Pause</button>
        <button id="nextTrack">Next</button>
    </div>
    <div id="currentTrack">
        <h2>Now Playing: <span id="trackName">N/A</span></h2>
    </div>
    
    <script src="https://sdk.scdn.co/spotify-player.js"></script>
    <script>
        window.onSpotifyWebPlaybackSDKReady = () => {
            const token = "BQC0E5exV5dG2Tl3zUfCiq4QV_k4Rwi3mSDUuMGvAlrw6y8R-8CjbPxMbXYUSPmXbj9VAv7QYJzgX2TXIqKj4eNcSdsNdP6z0esiDGXGTF-kxJ8aFGJmuyx-eue2rKcq3EnapfwxcOzKLZ25FRBxRft2AHL5zTv8Lpx56u0Bc8WqHAjnCLwt9aUHwFmiOWULomiHrI9JGbJRho8DLgL2YyV6aSxrUHDRKo5IA8G9";  // Dynamic token
            console.log("Access Token:", token);

            const player = new Spotify.Player({
                name: 'Web Playback SDK Quick Start Player',
                getOAuthToken: cb => { 
                    cb(token); 
                    console.log("OAuth token provided:", token); 
                },
                volume: 0.5
            });

            player.addListener('ready', ({ device_id }) => {
                console.log('Ready with Device ID:', device_id);
            });

            player.addListener('not_ready', ({ device_id }) => {
                console.log('Device ID has gone offline:', device_id);
            });

            player.addListener('initialization_error', ({ message }) => {
                console.error('Initialization Error:', message);
            });

            player.addListener('authentication_error', ({ message }) => {
                console.error('Authentication Error:', message);
            });

            player.addListener('account_error', ({ message }) => {
                console.error('Account Error:', message);
            });

            player.addListener('player_state_changed', state => {
                console.log('Player State Changed:', state);
                document.getElementById('trackName').innerText = state.track_window.current_track.name;
            });

            document.getElementById('togglePlay').onclick = function() {
                console.log("Toggle Play / Pause button clicked");
                player.togglePlay().then(() => {
                    console.log("Toggle Play successful");
                }).catch(error => {
                    console.error('Play Error:', error);
                });
            };

            document.getElementById('nextTrack').onclick = function() {
                console.log("Next Track button clicked");
                player.nextTrack().then(() => {
                    console.log("Skipped to next track");
                }).catch(error => {
                    console.error('Next Track Error:', error);
                });
            };

            document.getElementById('prevTrack').onclick = function() {
                console.log("Previous Track button clicked");
                player.previousTrack().then(() => {
                    console.log("Skipped to previous track");
                }).catch(error => {
                    console.error('Previous Track Error:', error);
                });
            };

            player.connect().then(success => {
                if (success) {
                    console.log('Connected to Spotify Player');
                } else {
                    console.error('Failed to connect to Spotify Player');
                }
            }).catch(error => {
                console.error('Connection Error:', error);
            });
        }
    </script>
</div>


    
</div>
{% endblock %}
